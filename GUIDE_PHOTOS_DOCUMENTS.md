# ğŸ“¸ Guide Photos & Documents - VÃ©hicules

**Bonne nouvelle !** Tout est dÃ©jÃ  implÃ©mentÃ© et fonctionnel ! ğŸ‰

---

## âœ… FonctionnalitÃ©s DÃ©jÃ  Disponibles

### 1ï¸âƒ£ **Onglet Photos**
- âœ… Ajouter photos par **appareil photo** (ğŸ“·)
- âœ… Ajouter photos depuis **bibliothÃ¨que** (ğŸ–¼ï¸)
- âœ… **Consulter** en plein Ã©cran (zoom)
- âœ… **Supprimer** les photos
- âœ… Grille responsive 2-3 colonnes

### 2ï¸âƒ£ **Onglet Documents** 
- âœ… Ajouter via **appareil photo** (scanner facture) (ğŸ“·)
- âœ… Ajouter depuis **photos** (ğŸ–¼ï¸)
- âœ… Ajouter **fichiers** (PDF, DOC, etc.) (ğŸ“„)
- âœ… **Consulter** :
  - Photos â†’ Modal plein Ã©cran
  - PDF/Documents â†’ Nouvelle page web
- âœ… **Supprimer** les documents
- âœ… MÃ©tadonnÃ©es (nom, type, taille, date)

---

## ğŸš€ Comment Utiliser

### AccÃ©der aux Photos/Documents

1. **SÃ©lectionnez un vÃ©hicule** dans la liste
2. Vous verrez **4 onglets** :
   - ğŸ“Š Infos
   - ğŸ”§ Entretien
   - ğŸ“¸ **Photos**
   - ğŸ“„ **Documents**

---

### Ajouter des Photos

**MÃ©thode 1 : Appareil Photo**
```
1. Cliquez sur "Appareil photo" (ğŸ“·)
2. Prenez la photo
3. âœ… Photo ajoutÃ©e instantanÃ©ment
```

**MÃ©thode 2 : BibliothÃ¨que**
```
1. Cliquez sur "BibliothÃ¨que" (ğŸ–¼ï¸)
2. SÃ©lectionnez une ou plusieurs photos
3. âœ… Photos ajoutÃ©es
```

**Consulter**
```
- Cliquez sur une photo â†’ Affichage plein Ã©cran
- Bouton Supprimer (âŒ) au survol
- Bouton Agrandir (ğŸ”) au survol
```

---

### Ajouter des Documents

**MÃ©thode 1 : Scanner une Facture (Appareil Photo)**
```
1. Cliquez sur "Appareil photo" (ğŸ“·)
2. Prenez la photo de la facture
3. âœ… Document ajoutÃ© avec type "photo"
```

**MÃ©thode 2 : Fichiers (Photos + PDF + Documents)**
```
1. Cliquez sur "Fichiers" (ğŸ“„)
2. SÃ©lectionnez :
   - Une ou plusieurs photos (.jpg, .png)
   - Des fichiers PDF (.pdf)
   - Des documents (.doc, .docx, .txt)
3. âœ… Documents ajoutÃ©s avec le bon type
```

**Consulter**
```
Photo :
  â†’ Cliquez dessus â†’ Modal plein Ã©cran
  
PDF/Document :
  â†’ Cliquez dessus â†’ Nouvelle page web avec le fichier
  
Supprimer :
  â†’ Bouton âŒ Ã  droite du document
```

---

## ğŸ“‹ Types de Fichiers SupportÃ©s

### Photos
- âœ… JPG / JPEG
- âœ… PNG
- âœ… GIF
- âœ… WebP
- âœ… HEIC (sur iOS)

### Documents
- âœ… PDF (factures, carte grise, etc.)
- âœ… Images (JPG, PNG)
- âœ… Documents Word (.doc, .docx)
- âœ… Texte (.txt)

---

## ğŸ¯ Cas d'Usage

### ğŸ“¸ Onglet Photos
```
- Photos de votre voiture (extÃ©rieur)
- Photos des modifications
- Photos avant/aprÃ¨s nettoyage
- Photos de dÃ©gÃ¢ts/rayures
- Photos de tuning
```

### ğŸ“„ Onglet Documents
```
- Factures de garage
- Carte grise
- Assurance
- ContrÃ´le technique
- Factures d'entretien
- Devis de rÃ©paration
- PV (si malheureusement...)
```

---

## ğŸ” Interface

### Onglet Photos
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“· Appareil   â”‚  ğŸ–¼ï¸ BibliothÃ¨que â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”           â”‚
â”‚  â”‚ ğŸ“¸â”‚  â”‚ ğŸ“¸â”‚  â”‚ ğŸ“¸â”‚   Grille   â”‚
â”‚  â””â”€â”€â”€â”˜  â””â”€â”€â”€â”˜  â””â”€â”€â”€â”˜    2-3     â”‚
â”‚  â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”  colonnes  â”‚
â”‚  â”‚ ğŸ“¸â”‚  â”‚ ğŸ“¸â”‚  â”‚ ğŸ“¸â”‚           â”‚
â”‚  â””â”€â”€â”€â”˜  â””â”€â”€â”€â”˜  â””â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Au survol : âŒ Supprimer | ğŸ” Agrandir
```

### Onglet Documents
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“· Appareil   â”‚    ğŸ“„ Fichiers   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“„  facture-vidange.pdf      â”‚ â”‚
â”‚ â”‚     PDF â€¢ 250 KB â€¢ 29/01/24  â”‚ â”‚
â”‚ â”‚                    ğŸ”— Ouvrir âŒâ”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ“¸  carte-grise.jpg          â”‚ â”‚
â”‚ â”‚     Photo â€¢ 1.2 MB â€¢ 15/01/24â”‚ â”‚
â”‚ â”‚                    ğŸ”— Ouvrir âŒâ”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Note: Le bouton "Fichiers" accepte photos ET documents
```

---

## ğŸ’¾ Stockage

### Comment c'est stockÃ© ?

**Photos** : Tableau d'URLs base64
```typescript
photos: [
  "data:image/jpeg;base64,/9j/4AAQSkZJRg...",
  "data:image/png;base64,iVBORw0KGgoA..."
]
```

**Documents** : Tableau d'objets JSON
```typescript
documents: [
  {
    id: "1706543210000-0",
    name: "facture-vidange.pdf",
    url: "data:application/pdf;base64,JVBERi0xLj...",
    type: "pdf",
    uploadedAt: "2024-01-29T10:00:00.000Z",
    size: 52428
  }
]
```

**OÃ¹ ?**
- ğŸ’¾ StockÃ© directement dans **Supabase** (table `vehicles`)
- ğŸ”’ SÃ©curisÃ© avec vos autres donnÃ©es
- ğŸ“¦ Pas besoin de serveur de fichiers sÃ©parÃ©

---

## âš¡ Performance

### Limites RecommandÃ©es

**Par VÃ©hicule :**
- ğŸ“¸ Photos : Max **10 photos** (~50 MB total)
- ğŸ“„ Documents : Max **20 documents** (~100 MB total)

**Pourquoi ?**
- Base64 augmente la taille de ~33%
- PostgreSQL limite : 1 GB par ligne (largement suffisant)

### Si Vous DÃ©passez

Si vous avez **beaucoup** de photos/documents :
1. **Supprimer** les anciennes photos non nÃ©cessaires
2. **Alternative** : Utiliser Supabase Storage (fichiers sÃ©parÃ©s, gratuit jusqu'Ã  1GB)

**Pour l'instant, le systÃ¨me actuel est parfait !** ğŸ‘Œ

---

## ğŸ› ï¸ Installation (Supabase)

### VÃ©rifier si les colonnes existent

```sql
SELECT column_name, data_type
FROM information_schema.columns
WHERE table_name = 'vehicles'
  AND column_name IN ('photos', 'documents');
```

**Si vide** â†’ ExÃ©cuter le script :

```sql
-- Voir le fichier /supabase-add-photos-documents.sql
```

---

## ğŸ§ª Test

### Test 1 : Ajouter une Photo
1. VÃ©hicule â†’ Onglet **Photos**
2. Cliquez sur **"Appareil photo"**
3. Prenez une photo
4. âœ… VÃ©rifiez qu'elle apparaÃ®t dans la grille
5. Cliquez dessus â†’ âœ… Modal plein Ã©cran

### Test 2 : Ajouter un Document PDF
1. VÃ©hicule â†’ Onglet **Documents**
2. Cliquez sur **"Fichiers"**
3. SÃ©lectionnez un PDF (ou une photo)
4. âœ… VÃ©rifiez qu'il apparaÃ®t avec icÃ´ne appropriÃ©e
5. Cliquez dessus â†’ âœ… Nouvelle page avec le fichier (ou modal pour photo)

### Test 3 : Scanner une Facture
1. VÃ©hicule â†’ Onglet **Documents**
2. Cliquez sur **"Appareil photo"**
3. Prenez photo d'une facture papier
4. âœ… Document ajoutÃ© comme "photo"
5. Cliquez dessus â†’ âœ… Affichage plein Ã©cran

---

## â“ FAQ

### "Je ne vois pas l'onglet Documents"
â†’ VÃ©rifiez que vous Ãªtes sur un **vÃ©hicule spÃ©cifique**, pas dans la liste

### "L'upload ne marche pas"
â†’ VÃ©rifiez :
1. Table `vehicles` a les colonnes `photos` et `documents`
2. Pas d'erreur dans la console (F12)
3. Fichier pas trop gros (< 10 MB recommandÃ©)

### "Le PDF ne s'affiche pas"
â†’ Certains navigateurs bloquent les pop-ups
1. Autorisez les pop-ups pour votre site
2. Ou cliquez avec Ctrl/Cmd pour ouvrir dans nouvel onglet

### "Puis-je ajouter plusieurs fichiers en mÃªme temps ?"
â†’ **OUI !** Tous les inputs acceptent `multiple`
- SÃ©lectionnez plusieurs photos d'un coup
- SÃ©lectionnez plusieurs PDFs d'un coup

### "Les photos ralentissent l'app ?"
â†’ Non, elles sont lazy-loaded
- ChargÃ©es uniquement quand vous ouvrez l'onglet
- OptimisÃ©es avec `ImageWithFallback`

---

## ğŸ“Š Architecture Technique

### Composants

```
VehicleDetail.tsx
  â”œâ”€ PhotosGallery.tsx
  â”‚   â”œâ”€ Bouton Appareil Photo
  â”‚   â”œâ”€ Bouton BibliothÃ¨que
  â”‚   â”œâ”€ Grille de photos
  â”‚   â””â”€ Modal plein Ã©cran
  â”‚
  â””â”€ DocumentsGallery.tsx
      â”œâ”€ Bouton Appareil
      â”œâ”€ Bouton Photos
      â”œâ”€ Bouton Fichiers
      â”œâ”€ Liste de documents
      â””â”€ Modal photo / Nouvelle page PDF
```

### Flow Upload

```
1. Utilisateur clique sur bouton
2. Input file cachÃ© dÃ©clenchÃ©
3. FileReader convertit en base64
4. updateVehicle() appelÃ©
5. Supabase mis Ã  jour
6. State React mis Ã  jour
7. âœ… UI rafraÃ®chie instantanÃ©ment
```

---

## âœ… Checklist Finale

- [x] Onglet Photos crÃ©Ã©
- [x] Onglet Documents crÃ©Ã©
- [x] Upload par appareil photo
- [x] Upload par bibliothÃ¨que
- [x] Upload de fichiers
- [x] Consultation photos (modal)
- [x] Consultation documents (nouvelle page)
- [x] Suppression photos
- [x] Suppression documents
- [x] MÃ©tadonnÃ©es (type, taille, date)
- [x] UI responsive mobile
- [x] Stockage Supabase
- [x] Type TypeScript `VehicleDocument`

---

**ğŸ‰ Tout fonctionne dÃ©jÃ  ! Il suffit d'exÃ©cuter le script SQL dans Supabase.**

**Ensuite, allez dans un vÃ©hicule â†’ Onglet Photos/Documents â†’ Amusez-vous ! ğŸ“¸ğŸ“„**
